<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darts Checkout Trainer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* Prevents double-tap zoom on mobile */
        }
        .keypad-btn {
            @apply flex items-center justify-center w-full h-14 text-xl font-semibold transition-transform duration-100 rounded-lg shadow-md active:scale-95 select-none;
        }
        .main-btn {
            @apply flex items-center justify-center w-full h-14 text-base font-semibold text-white transition-transform duration-100 rounded-lg shadow-md active:scale-95 select-none;
        }
        /* Styles for the hint toggle switch */
        #hint-toggle:checked ~ .dot {
            transform: translateX(100%);
            background-color: #FF904D;
        }
    </style>
</head>
<body class="bg-black flex items-center justify-center min-h-screen">
    <div class="w-full max-w-sm mx-auto bg-[#545454] text-white rounded-2xl shadow-2xl p-4 space-y-3 border border-[#FF904D]">
        
        <img src="https://drts-lab.github.io/Checkout-Calculator/assets/img/Header.png" alt="Darts Checkout Trainer Header" class="w-full rounded-lg mb-2">

        <!-- Dart Score Displays -->
        <div class="grid grid-cols-3 gap-2 text-center">
            <div>
                <div class="text-sm text-gray-300">Dart 1</div>
                <div id="dart1-display" class="bg-black text-white rounded-lg p-3 text-2xl font-bold h-16 flex items-center justify-center">-</div>
            </div>
            <div>
                <div class="text-sm text-gray-300">Dart 2</div>
                <div id="dart2-display" class="bg-black text-white rounded-lg p-3 text-2xl font-bold h-16 flex items-center justify-center">-</div>
            </div>
            <div>
                <div class="text-sm text-gray-300">Dart 3</div>
                <div id="dart3-display" class="bg-black text-white rounded-lg p-3 text-2xl font-bold h-16 flex items-center justify-center">-</div>
            </div>
        </div>

        <!-- Target Score Display -->
        <div class="text-center bg-black rounded-lg p-2">
            <div class="text-sm text-gray-300">Target / Remaining</div>
            <div id="remaining-display" class="text-6xl font-bold text-[#FF904D] tracking-tight">0</div>
        </div>

        <!-- Current Score Input -->
        <div class="text-center bg-black rounded-lg p-2">
            <div class="text-sm text-gray-300">Enter Score</div>
            <div id="current-input-display" class="text-4xl font-bold text-white tracking-tight h-12 flex items-center justify-center">-</div>
        </div>

        <!-- Hint Display Area -->
        <div id="hint-display-area" class="bg-black rounded-lg p-2 hidden">
             <div id="auto-hint-text" class="text-xl font-bold text-[#FF904D] tracking-tight min-h-[5rem] flex flex-col items-center justify-center space-y-2"></div>
        </div>
        
        <!-- Controls -->
        <div class="space-y-2">
            <div class="grid grid-cols-4 gap-2">
                 <button id="random-btn" class="main-btn bg-[#545454] border border-gray-600 hover:bg-gray-600">Random</button>
                 <button id="set-target-btn" class="main-btn bg-[#545454] border border-gray-600 hover:bg-gray-600">Set</button>
                 <button id="reset-btn" class="main-btn bg-[#545454] border border-gray-600 hover:bg-gray-600">Reset</button>
                 <button id="undo-btn" class="main-btn bg-[#545454] border border-gray-600 hover:bg-gray-600">Undo</button>
            </div>
            <div class="flex items-center justify-center bg-[#545454] border border-gray-600 rounded-lg h-14">
                <label for="hint-toggle" class="flex items-center cursor-pointer">
                    <span class="mr-3 text-white text-base font-semibold">Hints</span>
                    <div class="relative">
                        <input type="checkbox" id="hint-toggle" class="sr-only">
                        <div class="track block bg-black w-14 h-8 rounded-full"></div>
                        <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div>
                    </div>
                </label>
            </div>
        </div>

        <!-- Keypad -->
        <div class="space-y-2">
            <div class="grid grid-cols-4 gap-2">
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="60">T20</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="57">T19</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="54">T18</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="51">T17</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="48">T16</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="45">T15</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="30">T10</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400 score-btn" data-value="50">Bull</button>
            </div>
            <div class="grid grid-cols-3 gap-2">
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="1">1</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="2">2</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="3">3</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="4">4</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="5">5</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="6">6</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="7">7</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="8">8</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="9">9</button>
                <button class="keypad-btn bg-gray-800 text-white hover:bg-gray-700" id="clear-input-btn">C</button>
                <button class="keypad-btn bg-black text-white hover:bg-gray-800 num-btn" data-value="0">0</button>
                <button class="keypad-btn bg-[#FF904D] text-black hover:bg-orange-400" id="submit-score-btn">SUBMIT</button>
            </div>
        </div>
    </div>

    <!-- Set Target Modal -->
    <div id="set-target-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden">
        <div class="bg-[#545454] rounded-lg shadow-xl p-6 text-center max-w-sm w-full border border-[#FF904D] text-white">
            <h3 class="text-lg font-bold mb-4">Set Manual Target</h3>
            <input type="number" id="target-input" class="w-full bg-black border border-gray-600 text-white rounded-lg p-3 text-center text-2xl font-bold" placeholder="e.g., 121">
            <div class="grid grid-cols-2 gap-2 mt-4">
                 <button id="confirm-set-target-btn" class="h-14 flex items-center justify-center text-base font-semibold text-black transition-transform duration-100 bg-[#FF904D] hover:bg-orange-400 rounded-lg shadow-md active:scale-95 select-none">Set</button>
                 <button id="cancel-set-target-btn" class="main-btn bg-gray-700 hover:bg-gray-600">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM ELEMENTS ---
            const remainingDisplay = document.getElementById('remaining-display');
            const currentInputDisplay = document.getElementById('current-input-display');
            const dartDisplays = [
                document.getElementById('dart1-display'),
                document.getElementById('dart2-display'),
                document.getElementById('dart3-display')
            ];
            const randomBtn = document.getElementById('random-btn');
            const resetBtn = document.getElementById('reset-btn');
            const undoBtn = document.getElementById('undo-btn');
            const scoreBtns = document.querySelectorAll('.score-btn');
            const numBtns = document.querySelectorAll('.num-btn');
            const clearInputBtn = document.getElementById('clear-input-btn');
            const submitScoreBtn = document.getElementById('submit-score-btn');
            
            // Hint Elements
            const hintToggle = document.getElementById('hint-toggle');
            const hintDisplayArea = document.getElementById('hint-display-area');
            const autoHintText = document.getElementById('auto-hint-text');

            // Set Target Modal
            const setTargetBtn = document.getElementById('set-target-btn');
            const setTargetModal = document.getElementById('set-target-modal');
            const targetInput = document.getElementById('target-input');
            const confirmSetTargetBtn = document.getElementById('confirm-set-target-btn');
            const cancelSetTargetBtn = document.getElementById('cancel-set-target-btn');
            
            // --- STATE ---
            let state = {
                target: 0,
                remaining: 0,
                darts: [],
                currentInput: '',
                hintsEnabled: false,
            };
            
            // --- DART DATA & CHECKOUT LOGIC ---
            const standardCheckouts = {
                170: "T20, T20, DBull", 167: "T20, T19, DBull", 164: "T20, T18, DBull", 161: "T20, T17, DBull",
                160: "T20, T20, D20", 158: "T20, T20, D19", 157: "T20, T19, D20", 156: "T20, T20, D18",
                155: "T20, T19, D19", 154: "T20, T18, D20", 153: "T20, T19, D18", 152: "T20, T20, D16",
                151: "T20, T17, D20", 150: "T20, T18, D18", 149: "T20, T19, D16", 148: "T20, T16, D20",
                147: "T20, T17, D18", 146: "T20, T18, D16", 145: "T20, T15, D20", 144: "T20, T20, D12",
                143: "T20, T17, D16", 142: "T20, T14, D20", 141: "T20, T19, D12", 140: "T20, T20, D10",
                139: "T19, T14, D20", 138: "T20, T18, D12", 137: "T19, T16, D16", 136: "T20, T20, D8",
                135: "T20, T17, D12", 134: "T20, T14, D16", 133: "T20, T13, D16", 132: "T20, T16, D12",
                131: "T20, T13, D16", 130: "T20, T20, D5", 129: "T19, T16, D12", 128: "T18, T14, D16",
                127: "T20, T17, D8", 126: "T19, T19, D6", 125: "Bull, T20, D20", 124: "T20, T16, D8",
                123: "T19, T16, D9", 122: "T18, T20, D4", 121: "T17, T10, D20", 120: "T20, S20, D20",
                119: "T19, S10, D16", 118: "T20, S18, D20", 117: "T20, S17, D20", 116: "T20, S16, D20",
                115: "T20, S15, D20", 114: "T20, S14, D20", 113: "T20, S13, D20", 112: "T20, S12, D20",
                111: "T20, S19, D16", 110: "T20, S18, D16", 109: "T19, S20, D16", 108: "T20, S16, D16",
                107: "T19, S18, D16", 106: "T20, S14, D16", 105: "T19, S16, D16", 104: "T18, S18, D16",
                103: "T20, S3, D20", 102: "T20, S10, D16", 101: "T20, S1, D20", 100: "T20, D20",
                99: "T19, S10, D16", 98: "T20, D19", 97: "T19, D20", 96: "T20, D18", 95: "T19, D19",
                94: "T18, D20", 93: "T19, D18", 92: "T20, D16", 91: "T17, D20", 90: "T20, D15",
                89: "T19, D16", 88: "T16, D20", 87: "T17, D18", 86: "T18, D16", 85: "T15, D20",
                84: "T20, D12", 83: "T17, D16", 82: "T14, D20", 81: "T19, D12", 80: "T16, D16",
                79: "T19, D11", 78: "T18, D12", 77: "T19, D10", 76: "T20, D8", 75: "T17, D12",
                74: "T14, D16", 73: "T19, D8", 72: "T16, D12", 71: "T13, D16", 70: "T10, D20",
                69: "T15, D12", 68: "T20, D4", 67: "T17, D8", 66: "T10, D18", 65: "T19, D4",
                64: "T16, D8", 63: "T13, D12", 62: "T10, D16", 61: "T15, D8", 60: "S20, D20",
                59: "S19, D20", 58: "S18, D20", 57: "S17, D20", 56: "S16, D20", 55: "S15, D20",
                54: "S14, D20", 53: "S13, D20", 52: "S12, D20", 51: "S19, D16", 50: "DBull",
                49: "S17, D16", 48: "S16, D16", 47: "S15, D16", 46: "S14, D16", 45: "S13, D16",
                44: "S12, D16", 43: "S11, D16", 42: "S10, D16", 41: "S9, D16", 40: "D20",
                39: "S7, D16", 38: "D19", 37: "S5, D16", 36: "D18", 35: "S3, D16", 34: "D17",
                33: "S1, D16", 32: "D16", 31: "S15, D8", 30: "D15", 29: "S13, D8", 28: "D14",
                27: "S11, D8", 26: "D13", 25: "S9, D8", 24: "D12", 23: "S7, D8", 22: "D11",
                21: "S5, D8", 20: "D10", 19: "S3, D8", 18: "D9", 17: "S1, D8", 16: "D8",
                15: "S7, D4", 14: "D7", 13: "S5, D4", 12: "D6", 11: "S3, D4", 10: "D5",
                9: "S1, D4", 8: "D4", 7: "S3, D2", 6: "D3", 5: "S1, D2", 4: "D2", 3: "S1, D1", 2: "D1"
            };

            // --- UI FUNCTIONS ---
            const updateAutoHint = () => {
                if (!state.hintsEnabled) return;

                const route = standardCheckouts[state.remaining] || null;
                let html = '';
                
                if (route) {
                    html = `<div class="w-full flex justify-center px-4"><span>${route}</span></div>`;
                } else {
                    html = '<p>No checkout available</p>';
                }
                
                autoHintText.innerHTML = html;
            };

            const updateMainDisplay = () => {
                remainingDisplay.textContent = state.remaining;
                dartDisplays.forEach((display, i) => {
                    display.textContent = state.darts[i] !== undefined ? state.darts[i] : '-';
                });
                remainingDisplay.classList.remove('text-red-600', 'text-[#FF904D]');
                
                if (state.remaining === 0) {
                    remainingDisplay.classList.add('text-[#FF904D]');
                } else if (state.remaining < 0 || state.remaining === 1) {
                    remainingDisplay.classList.add('text-red-600');
                } else {
                    remainingDisplay.classList.add('text-[#FF904D]');
                }
                updateAutoHint();
            };

            const updateInputDisplay = () => {
                currentInputDisplay.textContent = state.currentInput || '-';
            };

            const clearInput = () => {
                state.currentInput = '';
                updateInputDisplay();
            };
            
            const randomCheckout = () => {
                state.target = Math.floor(Math.random() * (170 - 61 + 1)) + 61;
                state.remaining = state.target;
                state.darts = [];
                clearInput();
                updateMainDisplay();
            };

            const setTarget = (newTarget) => {
                state.target = newTarget;
                state.remaining = newTarget;
                state.darts = [];
                clearInput();
                updateMainDisplay();
            };

            const resetTurn = () => {
                state.remaining = state.target;
                state.darts = [];
                clearInput();
                updateMainDisplay();
            };

            const handleScoreInput = (score) => {
                if (state.darts.length >= 3 || state.remaining <= 1) return;
                if (score > state.remaining) { // Can't score more than remaining
                    showToast("Score too high", "error");
                    clearInput();
                    return;
                }

                state.darts.push(score);
                state.remaining -= score;
                clearInput();
                updateMainDisplay();
                checkGameState();
            };



            const checkGameState = () => {
                if (state.remaining === 0) {
                    // Proper checkout requires the last dart to be a double, but we'll simplify for the calculator
                    showToast("Checkout!", "success");
                    setTimeout(randomCheckout, 1500);
                } else if (state.remaining < 0 || state.remaining === 1) {
                    showToast("Bust!", "error");
                    setTimeout(resetTurn, 1500);
                } else if (state.darts.length === 3) {
                    showToast("Turn Over", "info");
                }
            };
            
            const undoLastScore = () => {
                if (state.darts.length > 0) {
                    const lastScore = state.darts.pop();
                    state.remaining += lastScore;
                    clearInput();
                    updateMainDisplay();
                }
            };

            const appendToInput = (digit) => {
                if (state.currentInput.length >= 3) return;
                const newScore = parseInt(state.currentInput + digit, 10);
                if (newScore > 180) return;
                state.currentInput += digit;
                updateInputDisplay();
            };
            
            const submitInput = () => {
                const score = parseInt(state.currentInput, 10);
                if (!isNaN(score) && score >= 0) {
                    handleScoreInput(score);
                }
            };
            
            const showToast = (message, type = 'info') => {
                const toast = document.createElement('div');
                let bgColor = 'bg-[#545454]';
                if (type === 'success') bgColor = 'bg-[#FF904D] text-black';
                if (type === 'error') bgColor = 'bg-red-600 text-white';

                toast.className = `fixed bottom-5 right-1/2 translate-x-1/2 ${bgColor} py-2 px-4 rounded-lg shadow-lg text-lg animate-pulse`;
                toast.textContent = message;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 1400);
            };

            // Modal Functions
            const showSetTargetModal = () => setTargetModal.classList.remove('hidden');
            const closeSetTargetModal = () => {
                setTargetModal.classList.add('hidden');
                targetInput.value = '';
            }

            const handleSetTargetConfirm = () => {
                const newTargetValue = parseInt(targetInput.value, 10);
                if (!isNaN(newTargetValue) && newTargetValue > 1 && newTargetValue <= 170) {
                    setTarget(newTargetValue);
                    closeSetTargetModal();
                } else {
                    showToast("Invalid target (2-170)", "error");
                }
            };

            // --- EVENT LISTENERS ---
            randomBtn.addEventListener('click', randomCheckout);
            resetBtn.addEventListener('click', resetTurn);
            undoBtn.addEventListener('click', undoLastScore);
            clearInputBtn.addEventListener('click', clearInput);
            submitScoreBtn.addEventListener('click', submitInput);
            hintToggle.addEventListener('change', () => {
                state.hintsEnabled = hintToggle.checked;
                if (state.hintsEnabled) {
                    hintDisplayArea.classList.remove('hidden');
                    updateAutoHint();
                } else {
                    hintDisplayArea.classList.add('hidden');
                }
            });

            setTargetBtn.addEventListener('click', showSetTargetModal);
            cancelSetTargetBtn.addEventListener('click', closeSetTargetModal);
            confirmSetTargetBtn.addEventListener('click', handleSetTargetConfirm);
            
            scoreBtns.forEach(button => button.addEventListener('click', () => {
                handleScoreInput(parseInt(button.dataset.value, 10));
            }));
            
            numBtns.forEach(button => button.addEventListener('click', () => {
                appendToInput(button.dataset.value);
            }));

            // --- INITIALIZATION ---
            setTarget(0); // Start with a default target of 0
        });
    </script>
</body>
</html>

